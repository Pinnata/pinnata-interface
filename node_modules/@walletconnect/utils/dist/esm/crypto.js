import * as ecies25519 from "ecies-25519";
import * as encUtils from "enc-utils";
export function generateKeyPair() {
    const keyPair = ecies25519.generateKeyPair();
    return {
        privateKey: encUtils.arrayToHex(keyPair.privateKey),
        publicKey: encUtils.arrayToHex(keyPair.publicKey),
    };
}
export function generateRandomBytes32() {
    return encUtils.arrayToHex(ecies25519.randomBytes(32));
}
export function deriveSharedKey(privateKeyA, publicKeyB) {
    const sharedKey = ecies25519.derive(encUtils.hexToArray(privateKeyA), encUtils.hexToArray(publicKeyB));
    return encUtils.arrayToHex(sharedKey);
}
export async function sha256(msg) {
    const hash = await ecies25519.sha256(encUtils.hexToArray(msg));
    return encUtils.arrayToHex(hash);
}
export async function encrypt(params) {
    const msg = encUtils.utf8ToArray(params.message);
    const sharedKey = encUtils.hexToArray(params.sharedKey);
    const publicKey = encUtils.hexToArray(params.publicKey);
    const iv = typeof params.iv !== "undefined" ? encUtils.hexToArray(params.iv) : undefined;
    const encrypted = await ecies25519.encryptWithSharedKey(msg, sharedKey, publicKey, iv);
    return encUtils.arrayToHex(encrypted);
}
export async function decrypt(params) {
    const encrypted = encUtils.hexToArray(params.encrypted);
    const sharedKey = encUtils.hexToArray(params.sharedKey);
    const msg = await ecies25519.decryptWithSharedKey(encrypted, sharedKey);
    return encUtils.arrayToUtf8(msg);
}
//# sourceMappingURL=crypto.js.map