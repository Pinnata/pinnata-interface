{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { useContractKit } from \"@celo-tools/use-contractkit\";\nimport IERC20_ABI from \"src/abis/dahlia_contracts/IERC20.json\";\nimport { useAsyncState } from \"src/hooks/useAsyncState\";\nimport { isAddress, toBN } from \"web3-utils\";\nimport { getAddress } from \"ethers/lib/utils\";\nimport { safeBoxMap } from \"src/config\";\nexport const useERCmulti = tokens => {\n  _s();\n\n  const {\n    kit,\n    address\n  } = useContractKit();\n  const userAddress = address;\n  const call = React.useCallback(async () => {\n    let arr = [];\n\n    for (let token of tokens) {\n      const address = token.address;\n\n      if (!address || !isAddress(address) || !userAddress) {\n        arr.push(null);\n      }\n\n      ;\n      const ERCToken = new kit.web3.eth.Contract(IERC20_ABI.abi, address);\n      const allowance = toBN( //TODO: check allowance of homoraBank\n      await ERCToken.methods.allowance(userAddress, safeBoxMap.get(getAddress(address))).call());\n      const balance = toBN(await ERCToken.methods.balanceOf(userAddress).call());\n      arr.push({\n        allowance,\n        balance\n      });\n    }\n\n    return arr;\n  }, [kit, userAddress, tokens]);\n  return useAsyncState(null, call);\n};\n\n_s(useERCmulti, \"U6jrhdxPiR/2Ws75Q3dp3alj9wU=\", false, function () {\n  return [useContractKit, useAsyncState];\n});","map":{"version":3,"sources":["/Users/kylescott/src/nomspace-interface/src/hooks/useERCmulti.ts"],"names":["React","useContractKit","IERC20_ABI","useAsyncState","isAddress","toBN","getAddress","safeBoxMap","useERCmulti","tokens","kit","address","userAddress","call","useCallback","arr","token","push","ERCToken","web3","eth","Contract","abi","allowance","methods","get","balance","balanceOf"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,cAAT,QAA+B,6BAA/B;AACA,OAAOC,UAAP,MAAuB,uCAAvB;AAEA,SAASC,aAAT,QAA8B,yBAA9B;AACA,SAASC,SAAT,EAAoBC,IAApB,QAAyC,YAAzC;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,UAAT,QAA2B,YAA3B;AAIA,OAAO,MAAMC,WAAW,GAAIC,MAAD,IAAqB;AAAA;;AAC9C,QAAM;AAAEC,IAAAA,GAAF;AAAQC,IAAAA;AAAR,MAAmBV,cAAc,EAAvC;AACA,QAAMW,WAAW,GAAGD,OAApB;AACA,QAAME,IAAI,GAAGb,KAAK,CAACc,WAAN,CAAkB,YAAY;AACvC,QAAIC,GAAG,GAAG,EAAV;;AACA,SAAK,IAAIC,KAAT,IAAkBP,MAAlB,EAA0B;AACxB,YAAME,OAAO,GAAGK,KAAK,CAACL,OAAtB;;AACA,UAAI,CAACA,OAAD,IAAY,CAACP,SAAS,CAACO,OAAD,CAAtB,IAAmC,CAACC,WAAxC,EAAqD;AACjDG,QAAAA,GAAG,CAACE,IAAJ,CAAS,IAAT;AACH;;AAAA;AACD,YAAMC,QAAQ,GAAI,IAAIR,GAAG,CAACS,IAAJ,CAASC,GAAT,CAAaC,QAAjB,CACdnB,UAAU,CAACoB,GADG,EAEdX,OAFc,CAAlB;AAIE,YAAMY,SAAS,GAAGlB,IAAI,EACpB;AACA,YAAMa,QAAQ,CAACM,OAAT,CAAiBD,SAAjB,CAA2BX,WAA3B,EAAwCL,UAAU,CAACkB,GAAX,CAAenB,UAAU,CAACK,OAAD,CAAzB,CAAxC,EAA8EE,IAA9E,EAFc,CAAtB;AAIA,YAAMa,OAAO,GAAGrB,IAAI,CAAC,MAAMa,QAAQ,CAACM,OAAT,CAAiBG,SAAjB,CAA2Bf,WAA3B,EAAyCC,IAAzC,EAAP,CAApB;AACAE,MAAAA,GAAG,CAACE,IAAJ,CAAS;AAACM,QAAAA,SAAD;AAAYG,QAAAA;AAAZ,OAAT;AACH;;AACD,WAAOX,GAAP;AACH,GAnBY,EAmBV,CAACL,GAAD,EAAME,WAAN,EAAmBH,MAAnB,CAnBU,CAAb;AAoBA,SAAON,aAAa,CAAC,IAAD,EAAOU,IAAP,CAApB;AACD,CAxBM;;GAAML,W;UACcP,c,EAsBlBE,a","sourcesContent":["import React from \"react\";\nimport { useContractKit } from \"@celo-tools/use-contractkit\";\nimport IERC20_ABI from \"src/abis/dahlia_contracts/IERC20.json\"\nimport { IERC20 } from \"src/generated/IERC20\";\nimport { useAsyncState } from \"src/hooks/useAsyncState\";\nimport { isAddress, toBN, AbiItem } from \"web3-utils\";\nimport { getAddress } from \"ethers/lib/utils\";\nimport { safeBoxMap } from \"src/config\";\nimport { Token } from \"src/utils/token\";\n\n\nexport const useERCmulti = (tokens: Token[]) => {\n  const { kit , address} = useContractKit();\n  const userAddress = address; \n  const call = React.useCallback(async () => {\n      let arr = [];\n      for (let token of tokens) {\n        const address = token.address;\n        if (!address || !isAddress(address) || !userAddress) {\n            arr.push(null);\n        };\n        const ERCToken = (new kit.web3.eth.Contract(\n            IERC20_ABI.abi as AbiItem[],\n            address,\n          ) as unknown) as IERC20;\n          const allowance = toBN(\n            //TODO: check allowance of homoraBank\n            await ERCToken.methods.allowance(userAddress, safeBoxMap.get(getAddress(address))!).call()\n          );\n          const balance = toBN(await ERCToken.methods.balanceOf(userAddress!).call());\n          arr.push({allowance, balance});\n      }\n      return arr;\n  }, [kit, userAddress, tokens]);\n  return useAsyncState(null, call);\n};\n"]},"metadata":{},"sourceType":"module"}